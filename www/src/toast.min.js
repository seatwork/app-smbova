window.Toast={progress:{start(){this.status||(this.instance=$('<div class="toast-progress"></div>'),document.body.appendChild(this.instance),this.status=1,this._observe(),this._trickle=setInterval(()=>{this.status<99&&(this.status+=Math.round((100-this.status)/3*Math.random()))},300))},done(){this.status&&(this.status=100,clearInterval(this._trickle),setTimeout(()=>{this.status=0,this.instance.remove()},300))},_observe(){if(this._observed)return;this._observed=!0;let t=this.status;Object.defineProperty(this,"status",{get:()=>t,set:s=>{t=s,this.instance.style.width=s+"%"}})}},dialog(t){t=Object.assign({content:"",buttons:[{label:"确定",type:"primary",onClick:null}]},t);const s=$(`\n      <div class="toast-mask toast-dialog">\n        <div class="toast-dialog-panel">\n          <div class="toast-dialog-body">${t.content}</div>\n          <div class="toast-dialog-footer"></div>\n        </div>\n      </div>\n    `);s.hide=(()=>{a.addClass("toast-scale-out"),s.addClass("toast-fade-out"),s.on("animationend",()=>s.remove())});const e=s.querySelector(".toast-dialog-footer");t.buttons.forEach(t=>{let a=$(`<div class="toast-dialog-button ${t.type}">${t.label}</div>`);a.on("click",()=>{s.hide(),t.onClick&&t.onClick()}),e.appendChild(a)}),document.body.appendChild(s);const a=s.querySelector(".toast-dialog-panel");return a.addClass("toast-scale-in"),s.addClass("toast-fade-in"),s},alert(t){return this.dialog({content:t})},confirm(t,s){return instance=this.dialog({content:t,buttons:[{label:"确定",type:"primary",onClick:s},{label:"取消",type:"default",onClick:null}]})},info(t,s){if(Toast._singleton)return;Toast._singleton=!0,"number"==typeof s&&(s={duration:s}),s=Object.assign({duration:3e3,background:"rgba(0, 0, 0, 0.6)"},s);const e=$(`\n      <div class="toast-mask toast-info">\n        <div style="background:${s.background}">${t}</div>\n      </div>\n    `);document.body.appendChild(e),e.addClass("toast-fade-in"),setTimeout(()=>{e.addClass("toast-fade-out"),e.on("animationend",()=>{e.remove(),Toast._singleton=!1})},s.duration)},error(t,s={}){"number"==typeof s&&(s={duration:s}),s.background="rgba(217, 37, 7, 0.6)",this.info(t,s)},success(t,s={}){"number"==typeof s&&(s={duration:s}),s.background="rgba(43, 155, 23, 0.6)",this.info(t,s)},actionSheet(t=[]){const s=$('\n      <div>\n        <div class="toast-mask"></div>\n        <div class="toast-actionsheet"></div>\n      </div>\n    ');s.hide=(()=>{e.addClass("toast-fade-out"),a.addClass("toast-slide-down"),a.on("animationend",()=>s.remove())});const e=s.querySelector(".toast-mask");e.onclick=(()=>s.hide());const a=s.querySelector(".toast-actionsheet");return t.push({label:"取消",onClick:null}),t.forEach(t=>{let e=$(`<div class="toast-actionsheet-menu">${t.label}</div>`);e.on("click",()=>{s.hide(),t.onClick&&t.onClick()}),a.appendChild(e)}),document.body.appendChild(s),e.addClass("toast-fade-in"),a.addClass("toast-slide-up"),s}},Object.assign(Element.prototype,{addClass(t){return this.classList.add(t),this},removeClass(t){return this.classList.remove(t),this},on(t,s){return this.addEventListener(t,s),this},off(t,s){return this.removeEventListener(t,s),this},remove(){return this.parentNode&&this.parentNode.removeChild(this)}}),Object.assign(window,{$(t){if((t=t.replace("/[\t\r\n]/mg","").trim()).startsWith("<")){return document.createRange().createContextualFragment(t).firstChild}return document.querySelector(t)}});
